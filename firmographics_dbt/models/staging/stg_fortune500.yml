version: 2

models:
  - name: stg_fortune500
    description: "Staging model for Fortune 500 companies"

    columns:
      - name: company_name
        tests:
          - not_null
          - unique

      - name: slug
        tests:
          - not_null

      - name: company_rank
        tests:
          - not_null

      - name: assets_m
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0

      - name: revenues_m
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0

      - name: profits_m
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: -1000000000

      - name: market_value_m
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0

      - name: employees
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0

      - name: is_best_company
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: IS_CHANGE_THE_WORLD
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
      
      - name: DROPPED_IN_RANK
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: IS_FUTURE_50
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
      
      - name: IS_GLOBAL_500
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: IS_PROFITABLE
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
      
      - name: IS_NEWCOMER
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: HAS_FEMALE_CEO
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
      
      - name: FOUNDER_IS_CEO
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
      
      - name: IS_FASTEST_GROWING
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: IS_MOST_ADMIRED
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
      
      - name: CHANGE_RANK_500
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: -500
                max_value: 500
      
      - name: CHANGE_RANK_1000
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: -1000
                max_value: 1000

